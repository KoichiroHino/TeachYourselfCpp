# 独習C++ 第3章 クラス

## 3.1 constメンバー関数とmutable
- constメンバー関数：インスタンスがconstでも呼び出しが可能なメンバ関数のこと（getter関数としてよく使う）
- constメンバ関数からは、非constメンバ関数を呼び出せない
- 非constかconstかでオーバーロード出来るが、基本的にconst側を用意すれば十分
- mutableをメンバ変数に指定すると、constメンバ関数からも書き換えが可能
  - キャッシュを使うときに使う
  - 直感的ではなくなるので、十分な理由がある場合のみ使う

## 3.2 コンストラクタとデストラクタ
### コンストラクタ
- クラスと同じ名前
- 戻り値の型を書かない
- メンバー初期化リストで初期化する
- メンバー初期化リストでの初期化はコンストラクタ本体の処理よりも必ず先に実行される
- メンバー初期化リストで、省略されたメンバ変数はデフォルト値に初期化される

### デストラクタ
- 戻り値の型を書かない
- 自動的に呼ばれるため、オーバーロードが出来ない
- 引数を受け取ることが出来ない

RAII(Resource Acquisition Is Initialization)：
コンストラクタで必要なリソースを確保して、デストラクタで開放すること

## 3.3 初期値を受け取るコンストラクタ
- デフォルトコンストラクタ：引数がないコンストラクタ、コンパイラが自動生成する
- 引数を受け取るコンストラクタを1つでも定義すると、デフォルトコンストラクタが生成されなくなる（以下のどちらかをする）
  - デフォルトコンストラクタを自作で定義する
  - インスタンス生成の際に、コンストラクタに引数を渡す
- 委譲コンストラクタで処理をまとめることも可能

### 3.3.3 コピーコンストラクタ
- 多くの場合はコンパイラが自動生成するものを使う
  - ただし、メンバ変数がポインタ変数だと、アドレスのコピーをするため、プログラマが自作する
- デストラクタをユーザーが記述する場合、コピーコンストラクタは自動生成されない
- 通常はそのクラス自身のconst参照を引数で受け取る

### 3.3.5 explicit指定子
- A a = 42; のような暗黙のコンストラクタ呼び出しを禁止出来る
- コンストラクタにexplicitをつけることで、A a(42); という書き方を強制出来る
- 特に理由がなければexplicitをつけることを推奨

## 3.4 デフォルトの初期値
NSDMI(Non Static Data Member Initializer)：非静的メンバ変数の初期化子
- メンバ変数の宣言時にデフォルトの初期値を指定出来る
- コンストラクタで指定した初期値で初期化される
- メンバ初期化リストで省略されたメンバ変数にMSDMIの初期値が入る

## 3.6 オブジェクトポインタ
- インスタンス自身のポインタはthisで予約されている
- this->menber = member と書くと仮引数と同じ名前のメンバでも正常にセット出来る
- thisポインタ自体の値の変更は出来ない、かつ宣言も出来ない

## 3.7 クラス、構造体、共用体の関係性
- C++ではクラスと構造体はデフォルトのアクセス指定子が異なるだけ
  - クラス：private, 構造体：public
  - 構造体にメソッドをもたせることも可能
  - 構造体を別の構造体に継承（派生）させることも可能

## 3.8 フレンド関数の概要
- あるクラスのメンバ関数ではないが、そのクラスのprivateメンバにアクセス出来る関数
- 基本は使わないが、演算子オーバーロードやファクトリ関数で使用する
- メンバ関数ではないため、引数としてクラスのポインタや参照を1つ以上受け取るのが一般的
- プロトタイプ宣言にfriendをつける
- メンバ関数ではないので、普通の関数（フリー関数）と同じ呼び出し方
- クラスの外側ではフレンド宣言出来ないことに注意
- 2つ以上のクラスに対してフレンド宣言も可能

## 3.9 staticクラスメンバ
### staticメンバ変数
- クラスに対して結びつき、どのインスタンスとも結び付かないメンバ変数
- スコープ解決演算子(::)でアクセスする（クラス名::staticメンバ変数）
- クラスの外で宣言と初期化をする
- privateを付けると、そのクラス外からのアクセスが出来なくなる
- publicを付けると、そのクラス外からのアクセスが可能（＝グローバル変数）

### staticメンバ関数
- 特定のインスタンスに結び付かない特別なメンバ変数
  - staticでないクラスメンバにはアクセスが出来ない
- インスタンスを生成しなくてもメソッドを呼び出せる（オブジェクト指向ではないことに注意）
- staticメンバ変数と同じように、クラス名::staticメンバ関数で呼び出す
